---
title: "Reproduction of MCAR Results"
format:
  html:
    embed-resources: true
    #page-layout: full
---
```{r, echo=FALSE, message = FALSE, warning=FALSE}
source("./R/header.R")
load("./R/data_and_results/tables_and_plots.RData")
```

## Overview of the observed data fraction within the generated datasets
|Missing |Mechanism |  Mean| Median|    SD|
|:-------|:---------|-----:|------:|-----:|
|Small   |MCAR      | 0.950|  0.950| 0.006|
|Large   |MCAR      | 0.699|  0.699| 0.012|


## Proportion of positive definite covariance matrices
|         |MCAR Small |MCAR Large |
|:--------|:----------|:----------|
|Pairwise |0.537      |0.000      |
|Listwise |1.000      |0.000      |
|IPCA-reg |1.000      |1.000      |
|MI       |1.000      |1.000      |


## Comparison Mahalanobis-based distance and Frobenius-Norm
```{r, echo=FALSE}
#| label: fig-mahalanobis
#| fig-cap: "Boxplots of computed Mahalanobis-based-distance between the estimated covariances using complete data"
#| fig-pos: 'H'
#| out-width: "100%"
#| fig-height: 3

mahala_nobis_distanz_rep +
  ggtitle("Mahalanobis-Nobis-Distanz")
```
```{r, echo=FALSE}
#| label: fig-frobenius
#| fig-cap: "Boxplots of computed Frobenius-Norm between the estimated covariances using complete data"
#| fig-pos: 'H'
#| out-width: "100%"
#| fig-height: 3

frobenius_norm_rep +
  ggtitle("Frobenius-Norm")
```
**Note:** The replication of the Mahalanobis-based distance did not yield the expected results and failed to align closely with the original findings. As an alternative, the Frobenius norm was implemented. This approach produced distance patterns and relative differences highly similar to those reported in the reference paper. However, it should be noted that while the trends are consistent, the results operate on a different scale than the original metrics.

## Comparison of estimated proportions of explained variance
### MCAR Small
```{r, echo=FALSE}
#| label: fig-mcar_small
#| fig-cap: "Boxplots of difference of the estimated proportion of explained variance for MCAR small scenario"
#| fig-pos: 'H'
#| out-width: "100%"
#| fig-height: 6
#
plot_mcar_small
```
### MCAR Large
```{r, echo=FALSE, warning=FALSE}
#| label: fig-mcar_large
#| fig-cap: "Boxplots of difference of the estimated proportion of explained variance for MCAR large scenario"
#| fig-pos: 'H'
#| out-width: "100%"
#| fig-height: 3

plot_mcar_large
```
**Note:** Boxplots for the listwise and pairwise deletion are not displayed in this replication. This is because none of the generated covariance matrices for these methods were positive definite. These findings align with the original study, where the rates for positive definiteness were also zero (listwise) or negligible (0.002 for pairwise).